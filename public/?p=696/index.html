<!DOCTYPE html>
<html><head><script src="/chris_beeley_blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=chris_beeley_blog/livereload" data-no-instant defer></script>

  <title>Querying Google analytics data with R | Chris Beeley&#39;s blog</title>


  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <link rel="icon" href="../favicon.ico">



  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>




  </head>
<body><nav class="navbar navbar-expand-lg navbar-light ">

  <a class="navbar-brand" href="../">Chris Beeley&#39;s blog</a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">

    <span class="navbar-toggler-icon"></span>

  </button>



  <div class="collapse navbar-collapse" id="navbarSupportedContent">

    <ul class="navbar-nav ml-auto">

      

      

        <li class="navbar-item ">

          <a class="nav-link" href="../chris_beeley_blog/posts/" title="posts">posts</a>

        </li>

      

        <li class="navbar-item ">

          <a class="nav-link" href="https://github.com/ChrisBeeley/chris_beeley_blog" title="GitHub">github</a>

        </li>

      

    </ul>

  </div>

</nav>
  <h1>Querying Google analytics data with R</h1>

  
  
  <time datetime="2014-09-09T14:14:21&#43;00:00">September 9, 2014</time>

  <p>This post is in response to a question on Twitter, but it may be of interest to others. I produced a Shiny app for querying Google Analytics data for my <a href="https://www.packtpub.com/web-development/web-application-development-r-using-shiny">book</a>. The data on the live version which lives <a href="http://chrisbeeley.net:8080/shiny/GA/">here</a> is automatically pulled in via the API each time the application is run. That code cannot live on my <a href="https://github.com/ChrisBeeley">GitHub</a> because it needs the username and password for the API. So I’m reproducing it here. It’s very simple and is based on the wonderful R package rga which can be found <a href="https://github.com/skardhamar/rga">here</a>. Obviously the XXXXXXXs have got real things in the real version, this is the redacted version.</p>
<p>It’s pretty self explanatory really with the documentation for the package, so I won’t labour it by explaining any of the code. The only thing perhaps of note is the where=”ga.rga” instruction in the rga.open() call, this allows you to store a file called ga.rga which stores the authentication credentials of your application and means you don’t need to keep entering the code that Google gives you the first time you run it.</p>
<p>I’m happy to get questions as comments to this blog post or on my Twitter @chrisbeeley.</p>
<pre tabindex="0"><code>&lt;pre class=&#34;brush: r; title: ; notranslate&#34; title=&#34;&#34;&gt;

library(rga)

rga.open(instance = &#34;ga&#34;, where=&#34;ga.rga&#34;, 
         client.id = &#34;XXXXXX.apps.googleusercontent.com&#34;, 
         client.secret = &#34;XXXXXX&#34;)

analytics = ga$getData(XXXXXX, batch = TRUE,
                       start.date = &#34;2013-01-01&#34;,
                       metrics = &#34;ga:visitors, ga:visits, ga:bounces, ga:timeOnSite&#34;,
                       dimensions = &#34;ga:dateHour, ga:networkDomain&#34;,
                       sort = &#34;&#34;, filters = &#34;&#34;, segment = &#34;&#34;)

analytics$Date = as.Date(paste0(substr(analytics$dateHour, 1, 4), &#34;/&#34;,
                                substr(analytics$dateHour, 5, 6), &#34;/&#34;, substr(analytics$dateHour, 7, 8)))

analytics$Hour = as.numeric(substr(analytics$dateHour, 9, 10))

# change domain

analytics$Domain = factor(recode(analytics$networkDomain, &#39;&#34;nhs.uk&#34; = &#34;NHS&#34;; else = &#34;Other&#34;&#39;))
</code></pre>
  

<footer class="footer mt-5">

  <div class="container">

    <table class="table table-sm">

      <caption>Hugo Variables for current page</caption>

      <tr><th>Name</th><td>Querying Google analytics data with R</td></tr>

      <tr><th>Kind</th><td>page</td></tr>

      <tr><th>Type</th><td>posts</td></tr>

      <tr><th>List Page</th><td>.Pages</td></tr>

      <tr><th>IsPage</th><td>true</td></tr>

      <tr><th>IsHome</th><td>true</td></tr>

      <tr><th>Next</th><td>/Users/NatsSpace/chris_beeley_blog_update/content/posts/2014-10-24-all-hail-the-mighty-cron-setting-up-cron-jobs-and-a-mail-server-to-collect-their-output-logs.md</td></tr>

      <tr><th>Prev</th><td>/Users/NatsSpace/chris_beeley_blog_update/content/posts/2014-08-13-book-review-php-cookbook-by-david-sklar-and-adam-trachtenberg.md</td></tr>

      <tr><th>Section</th><td>/Users/NatsSpace/chris_beeley_blog_update/content/posts/_index.md</td></tr>

    </table>

  </div>

</footer></body>
</html>
